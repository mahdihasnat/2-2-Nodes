1. 
--no JOIN keyword used 
SELECT L.CITY, COUNT(*) AS NO_DEPT
FROM LOCATIONS L, DEPARTMENTS D
WHERE L.LOCATION_ID = D.LOCATION_ID 
GROUP BY L.CITY ; 




2.

SELECT D.DEPARTMENT_ID 
FROM DEPARTMENTS D
WHERE 
(SELECT AVG(E.SALARY)
FROM EMPLOYEES E
WHERE D.DEPARTMENT_ID = E.DEPARTMENT_ID)
>=
(
SELECT MAX(AVG(E.SALARY))
FROM DEPARTMENTS D, EMPLOYEES E
WHERE D.DEPARTMENT_ID = E.DEPARTMENT_ID 
GROUP BY D.DEPARTMENT_ID
)
UNION
SELECT D.DEPARTMENT_ID 
FROM DEPARTMENTS D
WHERE 
(SELECT AVG(E.SALARY)
FROM EMPLOYEES E
WHERE D.DEPARTMENT_ID = E.DEPARTMENT_ID)
<=
(
SELECT MIN(AVG(E.SALARY))
FROM DEPARTMENTS D, EMPLOYEES E
WHERE D.DEPARTMENT_ID = E.DEPARTMENT_ID 
GROUP BY D.DEPARTMENT_ID
)



3. 
SELECT E1.EMPLOYEE_ID,
(
SELECT C.COUNTRY_NAME
EMPLOYEES E, DEPARTMENTS D, LOCATIONS L, COUNTRIES C
WHERE E.DEPARTMENT_ID = D.DEPARTMENT_ID
AND D.LOCATION_ID = L.LOCATION_ID
AND L.COUNTRY_ID = C.COUNTRY_ID
)
FROM EMPLOYEES E1
WHERE (E1.EMPLOYEE_ID, E1.HIRE_DATE) IN 
(
SELECT  E1.EMPLOYEE_ID, MAX(HIRE_DATE) 
FROM EMPLOYEES E
GROUP BY E.DEPARTMENT_ID); 


4.

SELECT *
FROM employees w,
     employees m
WHERE w.manager_id = m.EMPLOYEE_ID
  AND w.salary> m.salary;


5. 

select e.EMPLOYEE_ID, last_name
from employees e
where EXISTS ( select *
		from employees e1
		where e1.manager_id = e.employee_id  )
AND EXISTS(	
SELECT * FROM JOB_HISTORY JO
WHERE E.EMPLOYEE_ID = JO.EMPLOYEE_ID 
AND E.JOB_ID <> JO.JOB_ID);



6. 
